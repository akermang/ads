<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- <link href="https://vjs.zencdn.net/7.8.2/video-js.css" rel="stylesheet" /> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.6.5/videojs-contrib-ads.css" /> -->
    <!-- <link rel="stylesheet" href="./videojs.ima.css" /> -->

    <!-- If you'd like to support IE8 (for Video.js versions prior to v7) -->
    <!-- <script src="https://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script> -->
    <!-- <script src="https://unpkg.com/video.js@6/dist/video.js"></script> -->
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> -->
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
          "gtm.start": new Date().getTime(),
          event: "gtm.js",
        });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-WPTQ3HT");
    </script>
    <!-- End Google Tag Manager -->
    <script src="js/fetch.js"></script>
    <script src="js/promise.min.js"></script>
    <script src="js/fetch.stream.js"></script>
    <script src="js/webrtc_adaptor.js"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <link rel="stylesheet" href="./style.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="מצלמות חוף שידור ישיר ישראל" />
    <meta
      name="keywords"
      content="כניסה למרינה,הרצליה,דרומי,מרינה צפון,מצלמת גלישה, גלים,מצלמת חוף הרצליה,גלישה,מצב,גלים,שידור,חי,מרינה,surf,live,Camera, מצלמות חוף"
    />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link
      rel="shortcut icon"
      type="image/png"
      href="https://akermang.github.io/WeatherApp/sun-favicon.png"
    />
    <title>מצלמות חופים | BeachCam | מצלמות חוף ישראל</title>
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-22782431-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-22782431-1");
    </script>
    <link rel="stylesheet" href="./style.css" />
    <style>
      @keyframes loader-spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes createBox {
        from {
          transform: scale(0);
        }

        to {
          transform: scale(1);
        }
      }

      body {
        background-color: black;
      }

      header {
        width: 100%;
        display: flex;
      }

      a {
        text-decoration: none;
      }

      div.animat-box-in {
        animation: createBox 0.25s;
      }

      .wrapper {
        width: 100%;
      }

      .row-flex {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 5px 0;
      }

      p,
      h1,
      h2 {
        text-align: center;
        margin: 0;
      }

      nav p {
        font-size: 20px;
        color: white;
      }

      h1,
      h2 {
        font-size: 30px;
      }

      .top-color {
        background-color: #9c27b0;
        color: white;
      }

      .text-center {
        text-align: center;
      }

      div.img {
        text-align: center;
        border-radius: 2px;
        background-color: rgb(241, 232, 232);
      }

      div.img:hover {
        box-shadow: 0 2px 10px rgba(0, 0, 0, 1.2);
      }

      .img img {
        width: 200px;
      }

      .message {
        color: wheat;
        text-align: center;
        font-size: medium;
      }

      .cams-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 6px;
        overflow: auto;
        color: wheat;
        width: 100%;
        max-width: 800px;
        margin: 0px auto;
        position: relative;
      }

      .cam-title {
        position: absolute;
        color: white;
        top: 5%;
        left: 6.5%;
        font-size: 22px;
        z-index: 1;
      }

      .cams-container.full-size {
        width: 100%;
        position: absolute;
        top: 0;
        left: 0;
        max-width: 100%;
        padding: 0;
      }

      .full-size img {
        width: 100%;
        height: 100%;
      }

      .cams-container P {
        margin: 0;
        min-width: 33%;
      }

      .loader-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        width: 100%;
        position: absolute;
        top: 0;
        bottom: 0;
        z-index: 1;
        min-height: 380px;
      }

      .loader {
        border: 4px solid #9E9E9E;
        border-left-color: rgb(158 158 158 / 24%);
        border-top-color: #9E9E9E;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: loader-spin 0.8s linear infinite;
        opacity: 1;
        opacity: 1;
      }

      .main-container {
        position: relative;
        z-index: 1;
        max-width: 800px;
        margin: auto;
        display: flex;
        justify-content: center;
      }

      .home-btn {
        padding: 4px;
        border-radius: 7px;
      }

      .home-btn.special {
        background-color: #008000a1;
      }

      a.home-btn:hover {
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      .jump-btn {
        display: none;
      }

      .jump-btn.show {
        z-index: 10;
        font-weight: bold;
        display: block;
        width: 40px;
        position: absolute;
        bottom: 0;
        right: 16%;
        height: 40px;
        background: transparent url("./images/jump.png") no-repeat;
        background-position: center center;
        background-size: contain;
        outline: 0 !important;
        border: 0;
        color: white;
        line-height: 2.5;
        text-align: center;
        opacity: 0.9;
        cursor: pointer;
      }

      .jump-btn.show:hover {
        opacity: 1;
      }

      /* #iframe-1 {
        position: relative;
        z-index: 2;
      } */

      footer {
        position: static;
        bottom: 20px;
        width: 100%;
        color: gold;
        z-index: 3;
      }

      .video-js .vjs-big-play-button {
        left: calc(50% - 1.5em);
        top: calc(50% - 0.8em);
      }

      .video-js .vjs-tech {
        height: unset;
        outline: none;
      }

      @media (max-width: 914px) {
        .cams-container P {
          min-width: 49%;
        }
      }

      @media (max-width: 768px) {
        .img img {
          width: 140px;
        }
        .cam-title {
          font-size: 19px;
        }
        h1,
        h2 {
          font-size: 22px;
        }
      }

      @media (max-width: 700px) {
        .loader-container {
          min-height: 250px;
        }

        .img img {
          width: 140px;
        }

        .cam-title {
          font-size: 19px;
          left: 5%;
        }
      }

      @media (max-width: 677px) {
        .my-video-dimensions {
          height: 55vw;
        }

        .img img {
          width: 140px;
        }

        .cam-title {
          font-size: 19px;
          left: 5%;
        }
      }

      @media (max-width: 599px) {
        header img {
          width: 115px;
        }

        .cams-container P {
          min-width: 100%;
        }

        .img img {
          width: 115px;
        }

        h1,
        h2 {
          font-size: 22px;
        }

        footer {
          position: static;
        }
      }

      .mobile-btn {
        display: none;
      }

      @media (max-width: 530px) {
        .loader-container {
          min-height: 180px;
        }

        footer {
          position: fixed;
        }
        .mobile-btn {
          display: block;
          background-color: #2196f3;
          margin: 32% 1em 0;
          cursor: pointer;
          cursor: pointer;
          width: 80vw;
          margin: auto;
          left: 0;
          right: 0;
          bottom: 63px;
          position: static;
        }
        /* iframe {
          max-height: 53vw;
        } */


        .row-flex {
          display: flex;
          flex-direction: column;
          justify-content: space-evenly;
          align-items: center;
          padding: 0;
        }

        nav p {
          font-size: 18px;
        }

        p.info {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="wrapper">
        <div class="w3-container top-color row-flex">
          <div class="home-btn">
            <div href="./index.html">
              <h1>BeachCam.co.il</h1>
              <!-- <p>לפירסום כאן 054-6817830</p> -->
            </div>
          </div>
          <div class="animat-box-in text-center">
            <h2>מצלמות חוף ישראל</h2>
            <label>אתר הבית לאוהבי הים והגלים</label>
          </div>
          <a
            class="home-btn title special"
            style="color: white;"
            href="./list.html"
          >
            <p class="info">שידור חי - מצלמת חוף</p>
            <h2>מצלמות חוף נוספות</h2>
          </a>
        </div>
      </div>
    </header>
    <nav>
      <div class="animat-box-in">
        <p>
          <a href="./marina.html">למרינה צפון |</a>
          <a href="./johnflorence.html">john Florence |</a>
          <a href="./list.html">מצלמות</a>
        </p>
      </div>
    </nav>
    <!-- <div id="video_info">
		Stream will start playing automatically<br />when it is live
	</div> -->

	<!-- HLS Player -->
	<div style="width: 100%; max-width: 640px; max-height: 480px;" id="video_container">
		<video id="video-player" style="display: none!important;"
			
			controls preload="auto" data-setup='{"fluid": true}'>
			<p class="vjs-no-js">
				To view this video please enable JavaScript, and consider upgrading
				to a web browser that <a
					href="http://videojs.com/html5-video-support/" target="_blank">supports
					HTML5 video</a>
			</p>
		</video>
	</div>
    <div id="page-content">
      <div id="video-container">
        <!-- <div class="cams-container"> -->
        <!-- WebRTC Player -->
        <video
          id="remoteVideo"
          playsinline
          style="
            display: block;
            width: 100%;
            max-width: 800px;
            max-height: 480px;
            margin: 0 auto;
            position: absolute;
          "
        ></video>
        <img
          id="play_button"
          src="images/play.png"
          onclick="playWebRTCVideo()"
          style="position: absolute; top: 30px; left: 30px; display: none;"
        />
        <!-- <button id="play-button">play</button> -->
        <button id="play-button">
          <img src="./images/poster.png" />
          <div id="play-icon">
            <img class="image-play" src="./images/play.png" alt="play" />
          </div>
          <div id="loader-container" class="loader-container">
            <div class="loader"></div>
          </div>
        </button>
        
        <div id="ad-container"></div>
        <script>
          /**
           * This page accepts 4 arguments.
           * 1. "id": the stream id to play.It is mandatory
           * 2. "token": the token to play stream. It's mandatory if token security is enabled on server side.
           * 3. "autoplay": To start playing automatically if streams is available. Optional. Default value is true
           * 4. "playOrder": the order which technologies is used in playing. Optional. Default value is "webrtc,hls".
           *     possible values are "hls,webrtc","webrtc","hls"
           */

          //The play order, player tries to play according to this order, if it can not play then tries following format

          var playOrder = ["hls", "webrtc"];

          var name = "117258289727856314740197";
          var token = "null";

          var pAutoplay = "null";
          var autoPlay = true;
          if (pAutoplay == "false" || isMobile()) {
            autoPlay = false;
          }

          var webRTCAdaptor = null;
          var streamsFolder = "streams";

          function webrtcNoStreamCallback() {
            /**
             * If HLS is in the play order then try to play HLS, if not wait for WebRTC stream
             * In some cases user may want to remove HLS from the order and force to play WebRTC only
             * in these cases player only waits for WebRTC streams
             */
            setTimeout(function () {
              if (playOrder.includes("hls")) {
                tryToHLSPlay(name, token, hlsNoStreamCallback);
                console.log("hls")
              } else {
                  console.log("webRTCAdaptor")
                webRTCAdaptor.getStreamInfo(name);
              }
            }, 2000);
          }

          function hlsNoStreamCallback() {
            // document.getElementById("video_info").innerHTML =
            //   "Stream will start playing automatically<br/>when it is live";
            setTimeout(function () {
              if (playOrder.includes("webrtc")) {
                // It means there is no HLS stream, so try to play WebRTC stream
                if (webRTCAdaptor == null) {
                  initializeWebRTCPlayer(name, token, webrtcNoStreamCallback);
                } else {
                  webRTCAdaptor.getStreamInfo(name);
                }
              } else {
                tryToHLSPlay(name, token, hlsNoStreamCallback);
              }
            }, 2000);
          }

          function hideHLSElements() {
            // document.getElementById("video_container").style.display = "none";
          }

          function hideWebRTCElements() {
            document.getElementById("remoteVideo").style.display = "none";
            document.getElementById("play_button").style.display = "none";
          }

          function playWebRTCVideo() {
            document.getElementById("remoteVideo").style.display = "block";
            document
              .getElementById("remoteVideo")
              .play()
              .then(function (value) {
                //autoplay started
                document.getElementById("play_button").style.display = "none";
              })
              .catch(function (error) {
                //
                document.getElementById("play_button").style.display = "block";
                console.log("User interaction needed to start playing");
              });
          }

          function initializeHLSPlayer(name, extension, token) {
              console.log("initializeHLSPlayer")
            hideWebRTCElements();

            startHLSPlayer(name, extension, token);
          }

          function startHLSPlayer(name, extension, token) {
              console.log("startHLSPlayer")
            var type;
            var liveStream = false;
            if (extension == "mp4") {
              type = "video/mp4";
              liveStream = false;
            } else if (extension == "m3u8") {
              type = "application/x-mpegURL";
              liveStream = true;
            } else {
              console.log("Unknown extension: " + extension);
              return;
            }

            var preview = name;
            if (name.endsWith("_adaptive")) {
              preview = name.substring(0, name.indexOf("_adaptive"));
            }

            var player = videojs("video-player", {
              poster: "previews/" + preview + ".png",
            });

            player.src({
              src: "streams/" + name + "." + extension + "?token=" + token,
              type: type,
            });

            player.poster("previews/" + preview + ".png");

            if (autoPlay) {
              player.ready(function () {
                player.play();
              });
            }
            document.getElementById("video_container").style.display = "block";
            // document.getElementById("video_info").hidden = true;
          }

          function initializeWebRTCPlayer(name, token, noStreamCallback) {
              console.log("initializeWebRTCPlayer")
            hideHLSElements();

            document.getElementById("remoteVideo").style.display = "block";

            var pc_config = null;

            var sdpConstraints = {
              OfferToReceiveAudio: true,
              OfferToReceiveVideo: true,
            };
            var mediaConstraints = {
              video: false,
              audio: false,
            };
            //54.163.27.97:5080/WebRTCAppEE
            ws: var appName = location.pathname.substring(
              0,
              location.pathname.lastIndexOf("/") + 1
            );
            console.log("appName:", appName);
            var path =
              "100.26.23.113" + ":" + "5080/" + "LiveApp/" + "websocket";
            var websocketURL = "ws://" + path;

            if (location.protocol.startsWith("https")) {
              websocketURL = "wss://" + path;
            }

            //webRTCAdaptor is a global variable
            webRTCAdaptor = new WebRTCAdaptor({
              websocket_url: websocketURL,
              mediaConstraints: mediaConstraints,
              peerconnection_config: pc_config,
              sdp_constraints: sdpConstraints,
              remoteVideoId: "remoteVideo",
              isPlayMode: true,
              debug: true,
              callback: function (info, description) {
                if (info == "initialized") {
                  console.log("initialized");
                  webRTCAdaptor.getStreamInfo(name);
                } else if (info == "streamInformation") {
                  console.log("stream information");
                  webRTCAdaptor.play(name, token);
                } else if (info == "play_started") {
                  //joined the stream
                  console.log("play started");
                //   document.getElementById("video_info").style.display = "none";
                  // playWebRTCVideo();
                } else if (info == "play_finished") {
                  //leaved the stream
                  console.log("play finished");
                  //check that publish may start again
                  setTimeout(function () {
                    webRTCAdaptor.getStreamInfo(name);
                  }, 3000);
                } else if (info == "closed") {
                  //console.log("Connection closed");
                  if (typeof description != "undefined") {
                    console.log(
                      "Connecton closed: " + JSON.stringify(description)
                    );
                  }
                }
              },
              callbackError: function (error) {
                //some of the possible errors, NotFoundError, SecurityError,PermissionDeniedError

                console.log("error callback: " + JSON.stringify(error));

                if (error == "no_stream_exist") {
                  if (typeof noStreamCallback != "undefined") {
                    noStreamCallback();
                  }
                }
                if (error == "notSetRemoteDescription") {
                  /*
                   * If getting codec incompatible or remote description error, it will redirect HLS player.
                   */
                  tryToHLSPlay(name, token, hlsNoStreamCallback);
                }
              },
            });
          }

          if (name != "null") {
            if (name.startsWith(streamsFolder)) {
              /*
               * If name starts with streams, it's hls or mp4 file to be played
               */
              var lastIndexOfDot = name.lastIndexOf(".");
              streamPath = name.substring(
                streamsFolder.length + 1,
                lastIndexOfDot
              );
              var extension = name.substring(lastIndexOfDot + 1);
              initializeHLSPlayer(streamPath, extension, token);
            } else {
              /*
               * Check that which one is in the first order
               */
              if (playOrder[0] == "webrtc") {
                initializeWebRTCPlayer(name, token, webrtcNoStreamCallback);
              } else if (playOrder[0] == "hls") {
                tryToHLSPlay(name, token, hlsNoStreamCallback);
              } else {
                alert(
                  "Unsupported play order requested. Supported formats are webrtc and hls. Use something like playOrder=webrtc,hls"
                );
              }
            }
          } else {
            alert(
              "No stream specified. Please add ?id={STREAM_ID}  to the url"
            );
          }
        </script>

        <!-- </div> -->
      </div>
    </div>

    <a class="home-btn mobile-btn" style="color: white;" href="./list.html">
      <h1>מצלמות חוף נוספות</h1>
    </a>
    <footer>
      <p style="text-align: center;">
        <a style="color: gold;" href="./index.html"> מצלמת חוף Beach Cam </a>
      </p>
    </footer>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.6.5/videojs-contrib-ads.min.js"></script>
    <script src="videojs.ima.js"></script>
    <script src="player.js"></script> -->

    <script src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
    <script src="./ads.js"></script>
  </body>
</html>
